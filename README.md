# chat-evil
ChatGPTのAPIチャットのベースになりそうなものです。動作にはOpenAIのAPIキーが必要です。  
セットアップについては [setup.md](setup.md) を参照してください。

## チャットの入力
画面下部のテキストエリアにチャットを入力し、「Submit」ボタンを押すか、Ctrl+Enterでチャットを送信します。  

## チャットの設定
チャット画面右上のギアアイコンからチャットの設定を行うことができます。
* Select model  
使用するモデルを選択します。初回はgpt-3.5が、続きを行う場合は最後に選択されたモデルが設定されています。2024/1/1現在は次のモデルが使用可能です。
    * gpt-3.5-turbo-1106
    * gpt-4-1106-preview
    * gemini-pro
* Summarization?  
要約を行う。現在は動作していません。
* audio  
assistantのチャット内容をVOICEBOXでしゃべらせる設定です。ローカルなどにVOICEBOXのサーバーを起動させておいてください。
* システムプロンプト  
promptフォルダに保存された .md ファイルからシステムプロンプトを選択できます。システムプロンプトはDBにも保存できるため、そのうちそのデータから選択できるようにします。
* カスタムシステムプロンプト  
現在のシステムプロンプトを表示・編集します。編集画面に保存ボタンがありますが、チャットを開始しないとチャットデータができないため、そのままでは保存できません。  
システムプロンプトはチャット履歴の先頭に保存され、変更して保存するとその履歴の先頭のデータが直接更新されます。
* ワード置換  
画面に入力・表示される文言と、サーバに送信・受信する文言を置換するペアを登録・編集します。  
画面からの設定はまだ機能しませんが。DBに直接登録すれば有効です。
* メッセージをコピー  
やり取りをまとめてクリップボードにコピーします。
* 顔写真を選択  
アップロードされた顔写真を選択します。これもチャットが始まっていなければ保存は無効です（適用は可能）。人のアイコンをクリックすると登録画面が開きます。登録画面から登録したアイコンを反映するには再読み込みボタンをクリックします。

## VOICEVOXを使ってChatGPTを音声で聞く
画面上部のAudioトグルをオンにすることで、VOICEVOXの音声でChatGPTのチャットを読み上げます。  
この機能を利用するにはVOICEVOXサーバーへのアクセスが可能である必要があります。  

現在、新しい返信のVoiceが上手く切り替わらず、過去のVoiceを繰り返す不具合があります。それを途中で切るにはトグルをいったんオフにします。  

## 音声入力
画面上部の「voice REC」ボタンを押し続けながらしゃべることで、音声によるチャット入力が可能です。  
ボタン名に「REC」とありますが、音声はブラウザで処理されるだけで本サーバーには保存されません（ブラウザを提供している会社のサーバーには送られ、処理されます）。  

## チャットの履歴について
ChatGPTに履歴を持たせるアイディアとして、チャット中にそれまでの全体の会話について要約をしてもらい、それをシステムプロンプトに含める、ということを実装しています。  
APIではこの処理を任意のチャットのタイミングでバックエンドで行うことにより、利用者が意識することなく延々とチャットを楽しめるようにしてみたいと思っています。  

## 基本機能
* ログイン（/login）／ログアウト（/logout）
* ユーザ追加（/register_user）
* ユーザ追加用コード作成（/registration_code）、一覧表示（/registration_code_list）
* チャット画面（/）およびチャット（/chat へのajax）
* チャット一覧（/chat/list）
* モデレーション（/moderation）
